<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nebula Edge AI</title>
    <style>
        :root { --bg: #050510; --accent: #8a70ff; --text: #ffffff; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
        .screen { width: 360px; height: 740px; border: 2px solid #222; border-radius: 40px; display: none; flex-direction: column; overflow: hidden; position: relative; }
        .active { display: flex; }
        /* Simple Splash styles */
        #splash { justify-content: center; align-items: center; text-align: center; }
        .btn { background: var(--accent); color: white; border: none; padding: 15px 30px; border-radius: 20px; cursor: pointer; }
        /* Voice screen styles */
        #voice-screen { justify-content: center; align-items: center; }
        .orb { width: 150px; height: 150px; background: radial-gradient(circle, #00d4ff, var(--accent)); border-radius: 50%; filter: blur(15px); transition: 0.3s; }
        .pulse { animation: pulse 1s infinite; transform: scale(1.2); filter: blur(25px); }
        @keyframes pulse { 0%, 100% { opacity: 0.7; } 50% { opacity: 1; } }
    </style>
</head>
<body>

    <div id="splash" class="screen active">
        <h1>Nebula Edge</h1>
        <input type="text" id="userName" placeholder="Your Name" style="margin: 10px; padding: 10px; border-radius: 5px;">
        <button class="btn" onclick="startApp()">GET STARTED</button>
    </div>

    <div id="voice-screen" class="screen">
        <h2 id="greeting">Hello</h2>
        <div class="orb" id="orb"></div>
        <p id="status">Tap to speak</p>
        <button class="btn" id="micBtn" onclick="toggleMic()">ðŸŽ¤ Start/Stop</button>
    </div>

<script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    // THIS IS THE SECRET PART
    const API_KEY = "REPLACE_ME_BY_GITHUB_ACTIONS"; 
    
    let isListening = false;
    let name = "User";
    const genAI = new GoogleGenerativeAI(API_KEY);
    const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

    window.startApp = () => {
        name = document.getElementById('userName').value || "User";
        document.getElementById('greeting').innerText = `Hello, ${name}`;
        document.getElementById('splash').classList.remove('active');
        document.getElementById('voice-screen').classList.add('active');
    };

    window.toggleMic = () => {
        if (!isListening) {
            recognition.start();
            isListening = true;
            document.getElementById('orb').classList.add('pulse');
            document.getElementById('status').innerText = "Listening...";
        } else {
            recognition.stop();
            isListening = false;
            document.getElementById('orb').classList.remove('pulse');
        }
    };

    recognition.onresult = async (event) => {
        const text = event.results[0][0].transcript;
        document.getElementById('status').innerText = "Thinking...";
        
        const result = await model.generateContent(text);
        const aiText = result.response.text();
        
        const talk = new SpeechSynthesisUtterance(aiText);
        window.speechSynthesis.speak(talk);
        document.getElementById('status').innerText = "Nebula Edge is speaking...";
    };
</script>
</body>
</html>
